# PiDAL
PiDAL(Pi Data Access Layer) 是一个安全、易用、支持在线 Reshading、数据安全保障、支持跨 Sharding 事务的数据库中间件。不仅支持数据库在线扩容也支持数据库 Sharding 规则的重新调整。对跨 Sharding 的事务不仅提供了基于 XA 规范的分布式事务，还提供了异步、无入侵、高性能的分布式事务模式。
- [Github](https://github.com/pi-plan/pidal)

# TODO 
……

## Driver、Sidecar、DBProxy

一般情况下应用和数据进行交互的实现有三种模式。如下图
![数据访问层的三种模式](../static/pidal/db-access-way.png)

第一种是以 Driver 的方式潜入到应用层的代码中，这种方案入侵性最大，而且需要针对没个语言单独定制对应的 Driver。重复的工作量大，这里为什么提出这种方案呢？继续往下看。

第二种适合容器化做的比较好的项目，以 Sidecar 的方式运行，脱离语言的限制，而且是去中心化的，不会一个出问题，所有的都出问题。类似 Database mesh 的概念。

第三种是目前使用比较多的，也是介绍里面饿了么用的方案。就是针对DB 做 DB Proxy ，这种方案的有点比较明显，因为是中心化的，在管控的时候相对容易。

三种方式对比

| | Driver | Sidecar | DBProxy |
| :--- | :--- | :--- | :--- |
| 数据库支持类型 | 任意数据库 | 任意数据库 | 单一数据库 |
| 连接数消耗 | 高 | 高（同 Driver） | 低 |
| 编程语言支持 | 单一语言 | 任意语言 | 任意语言 |
| 性能损耗 | 损耗低 | 损耗低 | 损耗高 |
| 中心化 | 去中心化 | 去中心化 | 中心化 |
| 静态入口 | 无 | 无 | 有 |

三种方案，各有优缺点，不过抽象之后，会发现，三种方案，只是在和应用层的交互方式上有区别。比如 SQL 解析、数据分片、分布式事务、数据库治理等功能都是可以复用的。所以可以核心逻辑实现一种，在交互上封装出不同的方式，就能实现三种。

![dal](../static/pidal/pidal.png)